<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Security-Policy"
content="
default-src 'self';
script-src 'self' https://www.googletagmanager.com;
style-src 'self' 'unsafe-inline';
img-src 'self' data:;
connect-src https://www.google-analytics.com;
">

    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-FMWDNVD3DN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-FMWDNVD3DN');
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medscribe - Professional Transcription Trainer</title>
    <style>
        :root {
            --bg: #0f172a;
            --text: #f8fafc;
            --accent: #38bdf8;
            --correct: #4ade80;
            --wrong: #f87171;
            --card: #1e293b;
        }
        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Inter', 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        .container {
            width: 90%;
            max-width: 900px;
            text-align: center;
        }
        .header-stats {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-bottom: 25px;
        }
        .stat-box {
            background: var(--card);
            padding: 15px;
            border-radius: 12px;
            flex: 1;
            border: 1px solid #334155;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .stat-label { font-size: 0.75rem; text-transform: uppercase; color: var(--accent); letter-spacing: 1px; font-weight: bold; }
        .stat-value { font-size: 1.8rem; font-weight: 800; margin-top: 5px; }

        #text-display {
            background: var(--card);
            padding: 30px;
            border-radius: 15px;
            font-size: 1.3rem;
            line-height: 1.8;
            margin-bottom: 20px;
            text-align: left;
            user-select: none;
            min-height: 150px;
            border: 1px solid #334155;
        }
        #input-field {
            width: 100%;
            padding: 20px;
            font-size: 1.2rem;
            background: #0f172a;
            border: 2px solid #334155;
            border-radius: 10px;
            color: white;
            outline: none;
            transition: all 0.2s;
            box-sizing: border-box;
        }
        #input-field:focus { border-color: var(--accent); box-shadow: 0 0 15px rgba(56, 189, 248, 0.2); }

        .correct { color: var(--correct); }
        .incorrect { color: var(--wrong); border-bottom: 2px solid var(--wrong); }
        
        .controls { display: flex; gap: 10px; justify-content: center; margin-top: 25px; }
        button {
            padding: 12px 30px;
            background: var(--accent);
            color: #0f172a;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
        }
        button:hover { filter: brightness(1.1); }
    </style>
</head>
<body>

<div class="container">
    <h2 style="margin-bottom: 20px; color: var(--accent);">Medical Transcription Speed Lab</h2>
    <div class="header-stats">
        <div class="stat-box">
            <div class="stat-label">Timer</div>
            <div class="stat-value" id="timer">60s</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Mistakes</div>
            <div class="stat-value" id="mistake-count" style="color: var(--wrong);">0</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Live WPM</div>
            <div class="stat-value" id="current-wpm">0</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Best WPM</div>
            <div class="stat-value" id="high-score">0</div>
        </div>
    </div>

    <div id="text-display"></div>
    <input type="text" id="input-field" placeholder="Type the medical report above..." autofocus autocomplete="off">
    
    <div class="controls">
        <button onclick="resetTest()">Next Medical Report</button>
    </div>
</div>

<script>
const medicalParagraphs = [
    "The patient is a sixty-two-year-old male presenting with acute onset of substernal chest pain radiating to the left arm. An electrocardiogram revealed ST-segment elevation in the anterior leads, suggestive of an acute myocardial infarction.",
    "Physical examination showed a well-developed female in no apparent distress. The abdomen was soft and non-tender with no organomegaly or masses noted. Laboratory results indicate a white blood cell count of twelve thousand per microliter.",
    "Post-operative Diagnosis: Chronic cholecystitis with cholelithiasis. Procedure: Laparoscopic cholecystectomy. The patient was placed in the supine position and general anesthesia was induced without complications.",
    "Respiratory assessment showed bilateral wheezing and decreased breath sounds in the lower lobes. The patient was started on a nebulizer treatment of albuterol and ipratropium bromide to manage the acute exacerbation of asthma.",
    "Neurological findings were significant for a mild left-sided hemiparesis. A CT scan of the head showed a small area of hypodensity in the right parietal lobe, consistent with a recent ischemic cerebrovascular accident.",
    "The patient was prescribed five milligrams of amlodipine daily for hypertension and twenty milligrams of atorvastatin for hypercholesterolemia. Follow-up is scheduled in two weeks for a metabolic panel and blood pressure check."
];

let timeLeft = 60;
let timer = null;
let isStarting = false;
let mistakes = 0;
let highScore = localStorage.getItem('medScribeHighScore') || 0;

const display = document.getElementById('text-display');
const input = document.getElementById('input-field');
const timerEl = document.getElementById('timer');
const mistakeEl = document.getElementById('mistake-count');
const highScoreEl = document.getElementById('high-score');
const currentWpmEl = document.getElementById('current-wpm');

function init() {
    highScoreEl.innerText = highScore;
    const randomPara = medicalParagraphs[Math.floor(Math.random() * medicalParagraphs.length)];
    display.innerHTML = randomPara.split('').map(char => `<span>${char}</span>`).join('');
    
    input.value = "";
    input.disabled = false;
    timeLeft = 60;
    isStarting = false;
    mistakes = 0;
    timerEl.innerText = "60s";
    currentWpmEl.innerText = "0";
    mistakeEl.innerText = "0";
    clearInterval(timer);
    input.focus();
}

input.addEventListener('input', () => {
    if (!isStarting) {
        startTimer();
        isStarting = true;
    }

    const charArray = display.querySelectorAll('span');
    const inputArray = input.value.split('');
    let currentMistakes = 0;
    let correctCount = 0;

    charArray.forEach((charSpan, index) => {
        const char = inputArray[index];
        if (char == null) {
            charSpan.className = '';
        } else if (char === charSpan.innerText) {
            charSpan.className = 'correct';
            correctCount++;
        } else {
            charSpan.className = 'incorrect';
            currentMistakes++;
        }
    });

    mistakes = currentMistakes;
    mistakeEl.innerText = mistakes;

    let timeElapsed = 60 - timeLeft;
    if (timeElapsed > 0) {
        let liveWpm = Math.round((correctCount / 5) / (timeElapsed / 60));
        currentWpmEl.innerText = liveWpm;
    }

    if (inputArray.length >= charArray.length) {
        endTest();
    }
});

function startTimer() {
    timer = setInterval(() => {
        timeLeft--;
        timerEl.innerText = timeLeft + "s";
        if (timeLeft <= 0) endTest();
    }, 1000);
}

function endTest() {
    clearInterval(timer);
    input.disabled = true;
    const finalWpm = parseInt(currentWpmEl.innerText);

    if (finalWpm > highScore) {
        highScore = finalWpm;
        localStorage.setItem('medScribeHighScore', highScore);
        highScoreEl.innerText = highScore;
    }
    alert(`Test Complete!\nWPM: ${finalWpm}\nMistakes: ${mistakes}`);
}

function resetTest() {
    init();
}

init();
</script>

</body>

</html>

